Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/util.py", line 62, in call
    r = self.func(t, *rdds)
  File "/home/ubuntu/twitter.rx/streaming/python/twitter_stream.py", line 135, in tfunc
    texts = getSqlContextInstance(rdd.context).createDataFrame(rowRdd)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 404, in createDataFrame
    rdd, schema = self._createFromRDD(data, schema, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 285, in _createFromRDD
    struct = self._inferSchema(rdd, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 229, in _inferSchema
    first = rdd.first()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 1320, in first
    raise ValueError("RDD is empty")
ValueError: RDD is empty
>>>> BEGIN CASS
Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/util.py", line 62, in call
    r = self.func(t, *rdds)
  File "/home/ubuntu/twitter.rx/streaming/python/twitter_stream.py", line 135, in tfunc
    texts = getSqlContextInstance(rdd.context).createDataFrame(rowRdd)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 404, in createDataFrame
    rdd, schema = self._createFromRDD(data, schema, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 285, in _createFromRDD
    struct = self._inferSchema(rdd, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 245, in _inferSchema
    raise ValueError("Some of types cannot be determined by the "
ValueError: Some of types cannot be determined by the first 100 rows, please try again with sampling
Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/util.py", line 62, in call
    r = self.func(t, *rdds)
  File "/home/ubuntu/twitter.rx/streaming/python/twitter_stream.py", line 135, in tfunc
    texts = getSqlContextInstance(rdd.context).createDataFrame(rowRdd)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 404, in createDataFrame
    rdd, schema = self._createFromRDD(data, schema, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 285, in _createFromRDD
    struct = self._inferSchema(rdd, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 229, in _inferSchema
    first = rdd.first()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 1320, in first
    raise ValueError("RDD is empty")
ValueError: RDD is empty
Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/util.py", line 62, in call
    r = self.func(t, *rdds)
  File "/home/ubuntu/twitter.rx/streaming/python/twitter_stream.py", line 142, in tfunc
    bids = getSqlContextInstance(rddb.context).createDataFrame(rowRdd2)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 404, in createDataFrame
    rdd, schema = self._createFromRDD(data, schema, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 285, in _createFromRDD
    struct = self._inferSchema(rdd, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 229, in _inferSchema
    first = rdd.first()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 1320, in first
    raise ValueError("RDD is empty")
ValueError: RDD is empty
Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/util.py", line 62, in call
    r = self.func(t, *rdds)
  File "/home/ubuntu/twitter.rx/streaming/python/twitter_stream.py", line 142, in tfunc
    bids = getSqlContextInstance(rddb.context).createDataFrame(rowRdd2)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 404, in createDataFrame
    rdd, schema = self._createFromRDD(data, schema, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 285, in _createFromRDD
    struct = self._inferSchema(rdd, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 229, in _inferSchema
    first = rdd.first()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 1320, in first
    raise ValueError("RDD is empty")
ValueError: RDD is empty
Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/util.py", line 62, in call
    r = self.func(t, *rdds)
  File "/home/ubuntu/twitter.rx/streaming/python/twitter_stream.py", line 135, in tfunc
    texts = getSqlContextInstance(rdd.context).createDataFrame(rowRdd)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 404, in createDataFrame
    rdd, schema = self._createFromRDD(data, schema, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 285, in _createFromRDD
    struct = self._inferSchema(rdd, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 229, in _inferSchema
    first = rdd.first()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 1320, in first
    raise ValueError("RDD is empty")
ValueError: RDD is empty
Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/util.py", line 62, in call
    r = self.func(t, *rdds)
  File "/home/ubuntu/twitter.rx/streaming/python/twitter_stream.py", line 135, in tfunc
    texts = getSqlContextInstance(rdd.context).createDataFrame(rowRdd)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 404, in createDataFrame
    rdd, schema = self._createFromRDD(data, schema, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 285, in _createFromRDD
    struct = self._inferSchema(rdd, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 229, in _inferSchema
    first = rdd.first()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 1320, in first
    raise ValueError("RDD is empty")
ValueError: RDD is empty
Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/util.py", line 62, in call
    r = self.func(t, *rdds)
  File "/home/ubuntu/twitter.rx/streaming/python/twitter_stream.py", line 135, in tfunc
    texts = getSqlContextInstance(rdd.context).createDataFrame(rowRdd)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 404, in createDataFrame
    rdd, schema = self._createFromRDD(data, schema, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 285, in _createFromRDD
    struct = self._inferSchema(rdd, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 229, in _inferSchema
    first = rdd.first()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 1320, in first
    raise ValueError("RDD is empty")
ValueError: RDD is empty
Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/util.py", line 62, in call
    r = self.func(t, *rdds)
  File "/home/ubuntu/twitter.rx/streaming/python/twitter_stream.py", line 135, in tfunc
    texts = getSqlContextInstance(rdd.context).createDataFrame(rowRdd)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 404, in createDataFrame
    rdd, schema = self._createFromRDD(data, schema, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 285, in _createFromRDD
    struct = self._inferSchema(rdd, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 229, in _inferSchema
    first = rdd.first()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 1320, in first
    raise ValueError("RDD is empty")
ValueError: RDD is empty
Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/util.py", line 62, in call
    r = self.func(t, *rdds)
  File "/home/ubuntu/twitter.rx/streaming/python/twitter_stream.py", line 135, in tfunc
    texts = getSqlContextInstance(rdd.context).createDataFrame(rowRdd)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 404, in createDataFrame
    rdd, schema = self._createFromRDD(data, schema, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 285, in _createFromRDD
    struct = self._inferSchema(rdd, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 229, in _inferSchema
    first = rdd.first()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 1320, in first
    raise ValueError("RDD is empty")
ValueError: RDD is empty
Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/util.py", line 62, in call
    r = self.func(t, *rdds)
  File "/home/ubuntu/twitter.rx/streaming/python/twitter_stream.py", line 135, in tfunc
    texts = getSqlContextInstance(rdd.context).createDataFrame(rowRdd)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 404, in createDataFrame
    rdd, schema = self._createFromRDD(data, schema, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 285, in _createFromRDD
    struct = self._inferSchema(rdd, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 229, in _inferSchema
    first = rdd.first()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 1320, in first
    raise ValueError("RDD is empty")
ValueError: RDD is empty
Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/util.py", line 62, in call
    r = self.func(t, *rdds)
  File "/home/ubuntu/twitter.rx/streaming/python/twitter_stream.py", line 135, in tfunc
    texts = getSqlContextInstance(rdd.context).createDataFrame(rowRdd)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 404, in createDataFrame
    rdd, schema = self._createFromRDD(data, schema, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 285, in _createFromRDD
    struct = self._inferSchema(rdd, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 229, in _inferSchema
    first = rdd.first()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 1320, in first
    raise ValueError("RDD is empty")
ValueError: RDD is empty
Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/util.py", line 62, in call
    r = self.func(t, *rdds)
  File "/home/ubuntu/twitter.rx/streaming/python/twitter_stream.py", line 142, in tfunc
    bids = getSqlContextInstance(rddb.context).createDataFrame(rowRdd2)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 404, in createDataFrame
    rdd, schema = self._createFromRDD(data, schema, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 285, in _createFromRDD
    struct = self._inferSchema(rdd, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 229, in _inferSchema
    first = rdd.first()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 1320, in first
    raise ValueError("RDD is empty")
ValueError: RDD is empty
Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/util.py", line 62, in call
    r = self.func(t, *rdds)
  File "/home/ubuntu/twitter.rx/streaming/python/twitter_stream.py", line 142, in tfunc
    bids = getSqlContextInstance(rddb.context).createDataFrame(rowRdd2)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 404, in createDataFrame
    rdd, schema = self._createFromRDD(data, schema, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 285, in _createFromRDD
    struct = self._inferSchema(rdd, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 229, in _inferSchema
    first = rdd.first()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 1320, in first
    raise ValueError("RDD is empty")
ValueError: RDD is empty
Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/util.py", line 62, in call
    r = self.func(t, *rdds)
  File "/home/ubuntu/twitter.rx/streaming/python/twitter_stream.py", line 142, in tfunc
    bids = getSqlContextInstance(rddb.context).createDataFrame(rowRdd2)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 404, in createDataFrame
    rdd, schema = self._createFromRDD(data, schema, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 285, in _createFromRDD
    struct = self._inferSchema(rdd, samplingRatio)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/context.py", line 229, in _inferSchema
    first = rdd.first()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 1320, in first
    raise ValueError("RDD is empty")
ValueError: RDD is empty
+------------------+-------------------+--------------------+
|                id|        created_utc|             symptom|
+------------------+-------------------+--------------------+
|694386904029093888|2016-02-02 05:08:33|Depression: Feeli...|
|694386904029093888|2016-02-02 05:08:33|   Flu-like symptoms|
|694386904029093888|2016-02-02 05:08:33|Red or pimple-lik...|
|694386904029093888|2016-02-02 05:08:33|Cataplexy: Sudden...|
|694386904029093888|2016-02-02 05:08:33|A rash, which may...|
|694386904029093888|2016-02-02 05:08:33|Flashbacks, or fe...|
|694386992121905152|2016-02-02 05:08:54|Does not always c...|
|694386992121905152|2016-02-02 05:08:54|   Flu-like symptoms|
|694386992121905152|2016-02-02 05:08:54|Red or pimple-lik...|
|694386992121905152|2016-02-02 05:08:54|Cataplexy: Sudden...|
|694386992121905152|2016-02-02 05:08:54|A rash, which may...|
|694386992121905152|2016-02-02 05:08:54|Flashbacks, or fe...|
|694387017291923456|2016-02-02 05:09:00|Loss of interest ...|
|694387017291923456|2016-02-02 05:09:00|Some people get j...|
|694387017291923456|2016-02-02 05:09:00|Tender points on ...|
|694387017291923456|2016-02-02 05:09:00|Lying awake for a...|
|694387017291923456|2016-02-02 05:09:00|The feeling that ...|
|694387017291923456|2016-02-02 05:09:00|Sleep paralysis, ...|
|694387017291923456|2016-02-02 05:09:00|Chest pain when y...|
|694387017291923456|2016-02-02 05:09:00|Feeling as if you...|
+------------------+-------------------+--------------------+
only showing top 20 rows

+------------------+-------------------+--------------------+
|                id|        created_utc|           condition|
+------------------+-------------------+--------------------+
|694386904029093888|2016-02-02 05:08:33|        Lyme disease|
|694386904029093888|2016-02-02 05:08:33|             Malaria|
|694386904029093888|2016-02-02 05:08:33|                 HIV|
|694386904029093888|2016-02-02 05:08:33|            Impetigo|
|694386904029093888|2016-02-02 05:08:33|Post-traumatic st...|
|694386904029093888|2016-02-02 05:08:33|    Bipolar disorder|
|694386904029093888|2016-02-02 05:08:33|          Narcolepsy|
|694386904029093888|2016-02-02 05:08:33|         Hepatitis C|
|694386992121905152|2016-02-02 05:08:54|        Lyme disease|
|694386992121905152|2016-02-02 05:08:54|             Malaria|
|694386992121905152|2016-02-02 05:08:54|                 HIV|
|694386992121905152|2016-02-02 05:08:54|            Impetigo|
|694386992121905152|2016-02-02 05:08:54|Post-traumatic st...|
|694386992121905152|2016-02-02 05:08:54|          Narcolepsy|
|694386992121905152|2016-02-02 05:08:54|           Gonorrhea|
|694386992121905152|2016-02-02 05:08:54|         Hepatitis C|
|694387017291923456|2016-02-02 05:09:00|           Pneumonia|
|694387017291923456|2016-02-02 05:09:00|           Psoriasis|
|694387017291923456|2016-02-02 05:09:00|            Insomnia|
|694387017291923456|2016-02-02 05:09:00|        Fibromyalgia|
+------------------+-------------------+--------------------+
only showing top 20 rows

"{\"id\":694386904029093888,\"created_utc\":\"2016-02-02 05:08:33\",\"symptomtags\":[\"Depression: Feeling \\\"down\\\", sad, inactive, and hopeless\",\"Flu-like symptoms\",\"Red or pimple-like sores surrounded by red skin\",\"Cataplexy: Sudden, temporary muscle weakness or paralysis caused by strong emotions like anger, laughter, and surprise\",\"A rash, which may look like a bullseye\",\"Flashbacks, or feeling like the traumatic event is happening again\"],\"conditiontags\":[\"Lyme disease\",\"Malaria\",\"HIV\",\"Impetigo\",\"Post-traumatic stress disorder\",\"Bipolar disorder\",\"Narcolepsy\",\"Hepatitis C\"]}"
Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/util.py", line 62, in call
    r = self.func(t, *rdds)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/dstream.py", line 159, in <lambda>
    func = lambda t, rdd: old_func(rdd)
  File "/home/ubuntu/twitter.rx/streaming/python/twitter_stream.py", line 123, in process
    event.Event('toES', wonbidsJson)
  File "/usr/local/lib/python2.7/dist-packages/fluent/event.py", line 10, in __init__
    assert isinstance(data, dict), 'data must be a dict'
AssertionError: data must be a dict
>>>> BEGIN CASS
+------------------+-------------------+--------------------+
|                id|        created_utc|             symptom|
+------------------+-------------------+--------------------+
|694387138889011200|2016-02-02 05:09:29|The feeling that ...|
|694387122136940544|2016-02-02 05:09:25|Persistent worry ...|
|694387122136940544|2016-02-02 05:09:25|Inability to let ...|
|694387143087509509|2016-02-02 05:09:30|Women: Bleeding b...|
|694387143087509509|2016-02-02 05:09:30|Tender points on ...|
|694387143087509509|2016-02-02 05:09:30|Lying awake for a...|
|694387143087509509|2016-02-02 05:09:30|Men: Pain when ur...|
|694387143087509509|2016-02-02 05:09:30|Sleep paralysis, ...|
|694387143087509509|2016-02-02 05:09:30|   Flu-like symptoms|
|694387143087509509|2016-02-02 05:09:30|Red or pimple-lik...|
|694387143087509509|2016-02-02 05:09:30|Chest pain when y...|
|694387143087509509|2016-02-02 05:09:30|Cataplexy: Sudden...|
|694387143087509509|2016-02-02 05:09:30|A rash, which may...|
|694387143087509509|2016-02-02 05:09:30|Hallucinations wh...|
|694387143087509509|2016-02-02 05:09:30|Flashbacks, or fe...|
|694387126323011585|2016-02-02 05:09:26| Waking up too early|
|694387126323011585|2016-02-02 05:09:26|Coughing up blood...|
|694387126323011585|2016-02-02 05:09:26|Sleep paralysis, ...|
|694387126323011585|2016-02-02 05:09:26|   Coughing up blood|
|694387126323011585|2016-02-02 05:09:26|A bad cough that ...|
+------------------+-------------------+--------------------+
only showing top 20 rows

Traceback (most recent call last):
  File "/home/ubuntu/twitter.rx/streaming/python/twitter_stream.py", line 176, in <module>
    ssc.awaitTermination()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/streaming/context.py", line 247, in awaitTermination
  File "/usr/local/spark/python/lib/py4j-0.8.2.1-src.zip/py4j/java_gateway.py", line 536, in __call__
  File "/usr/local/spark/python/lib/py4j-0.8.2.1-src.zip/py4j/java_gateway.py", line 364, in send_command
  File "/usr/local/spark/python/lib/py4j-0.8.2.1-src.zip/py4j/java_gateway.py", line 473, in send_command
  File "/usr/lib/python2.7/socket.py", line 430, in readline
    data = recv(1)
KeyboardInterrupt
